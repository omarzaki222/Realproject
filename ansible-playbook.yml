---
- name: "Build and run Docker container with Ansible"
  hosts: localhost
  tasks:
    - name: Remove old container if it exists
      command: docker stop ansi
      ignore_errors: yes

    - name: Remove old container
      command: docker rm -f ansi
      ignore_errors: yes

    - name: Build Docker image from Dockerfile
      command: docker build -t ansible-img .
      args:
        chdir: /path/to/your/dockerfile  # Change to your Dockerfile's directory if needed

    - name: Tag the image
      command: docker tag ansible-img omarzaki222/python

    - name: Run container from ansible-img
      command: docker run -d --name ansi -p 5000:5000 ansible-img
